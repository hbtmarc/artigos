import{q as l,w as p,c as r,g as u,d,e as h,f as m,h as f,i as c}from"./index.esm2017.BeiKNkIx.js";import{db as A}from"./client.DCNKASv_.js";const n=f(A,"posts"),y=t=>{const s=t.data();return{id:t.id,...s}},i=t=>{const s=t.publishedAt??t.updatedAt;return s?s.toMillis():0};async function w(){const t=l(n,p("status","==","published"));return(await r(t)).docs.map(e=>{const o=e.data();return{id:e.id,...o}}).sort((e,o)=>i(o)-i(e))}async function x(){return(await r(n)).docs.map(a=>{const e=a.data();return{id:a.id,...e}}).sort((a,e)=>i(e)-i(a))}async function D(t){const s=await u(d(n,t));return s.exists()?y(s):null}async function q(t){const s=d(n,t.id),a=await u(s),e=a.exists()?a.data():null,o={title:t.title,excerpt:t.excerpt,type:t.type,tags:t.tags??[],status:t.status,content:t.content};a.exists()||(o.createdAt=c()),o.updatedAt=c(),t.status==="published"&&(!e||!e.publishedAt)&&(o.publishedAt=c()),await h(s,o,{merge:!0})}async function T(t){await m(d(n,t))}export{T as deletePostAdmin,D as getPostById,x as listAllPostsAdmin,w as listPublishedPosts,q as upsertPostAdmin};
